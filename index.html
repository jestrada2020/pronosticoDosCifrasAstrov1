<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pronóstico dos cifras Premium</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.0.0/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.7.1/dist/chart.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.3.1/papaparse.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@3.11.0/dist/tf.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/dayjs@1.10.7/dayjs.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>

</head>
<body>
    <div id="loading" class="loading" style="display: none;">
        <div class="spinner"></div>
        <p class="mt-4 text-indigo-700 font-semibold">Procesando datos...</p>
    </div>

    <div class="container mx-auto px-4 py-8">
        <header class="text-center mb-10">
            <h1 class="text-4xl font-bold text-indigo-800 mb-4">PRONÓSTICO dos cifras PREMIUM</h1>
            <p class="text-lg text-gray-600">Aplicación avanzada para pronósticos astrológicos con múltiples modelos predictivos</p>
        </header>

        <!-- File Upload Section -->
        <div class="bg-white rounded-lg shadow-lg p-6 mb-8">
            <h2 class="text-2xl font-semibold text-indigo-700 mb-4">Carga de Archivos</h2>
            
            <!-- Info Box -->
            <div class="bg-green-50 border border-green-200 rounded-lg p-4 mb-6">
                <div class="flex items-start">
                    <i class="fas fa-info-circle text-green-600 mt-1 mr-3"></i>
                    <div>
                        <h3 class="text-green-800 font-semibold mb-2">Instrucciones de Uso</h3>
                        <p class="text-green-700 text-sm mb-2">
                            <strong>Opción 1:</strong> Sube tus archivos CSV y haz clic en "Cargar y Procesar Datos"
                        </p>
                        <p class="text-green-700 text-sm">
                            <strong>Opción 2:</strong> Usa "Cargar Datos de Demostración" para probar la aplicación con datos sintéticos
                        </p>
                    </div>
                </div>
            </div>
            
            <div class="grid md:grid-cols-2 gap-6">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Archivo 1 (ProHOY-ASTROLUNA.csv):</label>
                    <div class="flex items-center">
                        <input type="file" id="file1" class="hidden" accept=".csv,.xlsx,.xls">
                        <label for="file1" class="bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded cursor-pointer">Seleccionar archivo</label>
                        <span id="file1Name" class="ml-3 text-sm text-gray-500">No se ha seleccionado ningún archivo</span>
                    </div>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Archivo 2 (ProInvHOY-ASTROLUNA.csv):</label>
                    <div class="flex items-center">
                        <input type="file" id="file2" class="hidden" accept=".csv,.xlsx,.xls">
                        <label for="file2" class="bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded cursor-pointer">Seleccionar archivo</label>
                        <span id="file2Name" class="ml-3 text-sm text-gray-500">No se ha seleccionado ningún archivo</span>
                    </div>
                </div>
            </div>
            <button id="loadData" class="mt-6 bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded font-medium">
                Cargar y Procesar Datos
            </button>
            <button id="testSystem" class="mt-6 ml-3 bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded font-medium">
                Cargar Datos de Demostración
            </button>
        </div>

        <!-- Control Panel Section -->
        <div class="bg-white rounded-lg shadow-lg p-6 mb-8">
            <h2 class="text-2xl font-semibold text-indigo-700 mb-4">Panel de Control</h2>
            <div class="grid md:grid-cols-3 gap-6">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2" for="varSelection">Variable de predicción:</label>
                    <select id="varSelection" class="w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500">
                        <option value="DC">DC</option>
                        <option value="EXT">EXT</option>
                        <option value="ULT2">ULT2</option>
                        <option value="PM2">PM2</option>
                        <option value="C1C3">C1C3</option>
                        <option value="C2C4">C2C4</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2" for="iterations">Iteraciones:</label>
                    <input type="number" id="iterations" class="w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500" value="300" min="50" max="5000">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2" for="numIndices">Índices a generar:</label>
                    <input type="number" id="numIndices" class="w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500" value="7" min="1" max="30">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2" for="numThreads">CPUs a utilizar:</label>
                    <input type="number" id="numThreads" class="w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500" value="4" min="1" max="16">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2" for="maxDepth">Profundidad de árboles:</label>
                    <input type="number" id="maxDepth" class="w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500" value="4" min="2" max="10">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2" for="learningRate">Tasa de aprendizaje:</label>
                    <input type="number" id="learningRate" class="w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500" value="0.7" min="0.01" max="1" step="0.01">
                </div>
            </div>
            <div class="mt-6">
                <label class="block text-sm font-medium text-gray-700 mb-2" for="forecastDays">Días de pronóstico:</label>
                <div class="slider-container">
                    <input type="range" id="forecastDays" class="w-full" min="1" max="30" value="7">
                    <span id="forecastDaysValue" class="text-indigo-700 font-semibold">7 días</span>
                </div>
            </div>
            <button id="runModels" class="mt-6 bg-indigo-600 hover:bg-indigo-700 text-white px-6 py-2 rounded font-medium">
                Ejecutar Pronósticos
            </button>
        </div>

        <!-- Models Section -->
        <div class="mb-8">
            <div class="flex flex-wrap mb-4 border-b">
                <button id="tab-xgboost" class="tab-button px-4 py-2 text-indigo-600 font-medium border-b-2 border-indigo-600">XGBoost</button>
                <button id="tab-lightgbm" class="tab-button px-4 py-2 text-gray-500 font-medium">LightGBM</button>
                <button id="tab-neuralnet" class="tab-button px-4 py-2 text-gray-500 font-medium">Redes Neuronales</button>
                <button id="tab-hybrid" class="tab-button px-4 py-2 text-gray-500 font-medium">Modelo Híbrido</button>
                <button id="tab-lstm" class="tab-button px-4 py-2 text-gray-500 font-medium">LSTM</button>
                <button id="tab-lstm-nn" class="tab-button px-4 py-2 text-gray-500 font-medium">LSTM-NN</button>
                <button id="tab-lstm-lightgbm" class="tab-button px-4 py-2 text-gray-500 font-medium">LSTM-LightGBM</button>
                <button id="tab-lstm-xgboost" class="tab-button px-4 py-2 text-gray-500 font-medium">LSTM-XGBoost</button>
                <button id="tab-consensus" class="tab-button px-4 py-2 text-gray-500 font-medium">Consenso</button>
            </div>

            <!-- XGBoost Tab Content -->
            <div id="content-xgboost" class="tab-content active">
                <div class="bg-white rounded-lg shadow-lg p-6">
                    <h3 class="text-2xl font-semibold text-indigo-700 mb-4">Pronóstico XGBoost</h3>
                    <div id="xgboost-timestamp" class="text-sm text-gray-500 mb-2">Esperando ejecución...</div>
                    <div class="grid md:grid-cols-2 gap-8">
                        <div>
                            <h4 class="text-lg font-semibold mb-3">Resultados Numéricos</h4>
                            <div class="table-container mb-6">
                                <table id="xgboostResults" class="w-full">
                                    <thead>
                                        <tr>
                                            <th>Fecha</th>
                                            <th>Predicción</th>
                                            <th>Valor Actual</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td colspan="3" class="text-center py-4 text-gray-500">Cargue los datos y ejecute el modelo para ver resultados</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <h4 class="text-lg font-semibold mb-3">Métricas de Error</h4>
                            <div class="table-container">
                                <table id="xgboostErrors" class="w-full">
                                    <thead>
                                        <tr>
                                            <th>Métrica</th>
                                            <th>Valor</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>MSE (Error Cuadrático Medio)</td>
                                            <td id="xgboost-mse">-</td>
                                        </tr>
                                        <tr>
                                            <td>MAE (Error Absoluto Medio)</td>
                                            <td id="xgboost-mae">-</td>
                                        </tr>
                                        <tr>
                                            <td>RMSE (Raíz del Error Cuadrático Medio)</td>
                                            <td id="xgboost-rmse">-</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <div>
                            <h4 class="text-lg font-semibold mb-3">Visualización de Resultados</h4>
                            <div class="chart-container">
                                <canvas id="xgboostChart"></canvas>
                            </div>
                            <div class="mt-6">
                                <h4 class="text-lg font-semibold mb-3">Próximos 7 días (Pronóstico)</h4>
                                <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-7 gap-3" id="xgboost-forecast">
                                    <!-- Forecast cards will be added here by JavaScript -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- LightGBM Tab Content -->
            <div id="content-lightgbm" class="tab-content">
                <div class="bg-white rounded-lg shadow-lg p-6">
                    <h3 class="text-2xl font-semibold text-indigo-700 mb-4">Pronóstico LightGBM</h3>
                    <div class="grid md:grid-cols-2 gap-8">
                        <div>
                            <h4 class="text-lg font-semibold mb-3">Resultados Numéricos</h4>
                            <div class="table-container mb-6">
                                <table id="lightgbmResults" class="w-full">
                                    <thead>
                                        <tr>
                                            <th>Fecha</th>
                                            <th>Predicción</th>
                                            <th>Valor Actual</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td colspan="3" class="text-center py-4 text-gray-500">Cargue los datos y ejecute el modelo para ver resultados</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <h4 class="text-lg font-semibold mb-3">Métricas de Error</h4>
                            <div class="table-container">
                                <table id="lightgbmErrors" class="w-full">
                                    <thead>
                                        <tr>
                                            <th>Métrica</th>
                                            <th>Valor</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>MSE (Error Cuadrático Medio)</td>
                                            <td id="lightgbm-mse">-</td>
                                        </tr>
                                        <tr>
                                            <td>MAE (Error Absoluto Medio)</td>
                                            <td id="lightgbm-mae">-</td>
                                        </tr>
                                        <tr>
                                            <td>RMSE (Raíz del Error Cuadrático Medio)</td>
                                            <td id="lightgbm-rmse">-</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <div>
                            <h4 class="text-lg font-semibold mb-3">Visualización de Resultados</h4>
                            <div class="chart-container">
                                <canvas id="lightgbmChart"></canvas>
                            </div>
                            <div class="mt-6">
                                <h4 class="text-lg font-semibold mb-3">Próximos 7 días (Pronóstico)</h4>
                                <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-7 gap-3" id="lightgbm-forecast">
                                    <!-- Forecast cards will be added here by JavaScript -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Neural Network Tab Content -->
            <div id="content-neuralnet" class="tab-content">
                <div class="bg-white rounded-lg shadow-lg p-6">
                    <h3 class="text-2xl font-semibold text-indigo-700 mb-4">Pronóstico Redes Neuronales</h3>
                    <div class="grid md:grid-cols-2 gap-8">
                        <div>
                            <h4 class="text-lg font-semibold mb-3">Resultados Numéricos</h4>
                            <div class="table-container mb-6">
                                <table id="neuralnetResults" class="w-full">
                                    <thead>
                                        <tr>
                                            <th>Fecha</th>
                                            <th>Predicción</th>
                                            <th>Valor Actual</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td colspan="3" class="text-center py-4 text-gray-500">Cargue los datos y ejecute el modelo para ver resultados</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <h4 class="text-lg font-semibold mb-3">Métricas de Error</h4>
                            <div class="table-container">
                                <table id="neuralnetErrors" class="w-full">
                                    <thead>
                                        <tr>
                                            <th>Métrica</th>
                                            <th>Valor</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>MSE (Error Cuadrático Medio)</td>
                                            <td id="neuralnet-mse">-</td>
                                        </tr>
                                        <tr>
                                            <td>MAE (Error Absoluto Medio)</td>
                                            <td id="neuralnet-mae">-</td>
                                        </tr>
                                        <tr>
                                            <td>RMSE (Raíz del Error Cuadrático Medio)</td>
                                            <td id="neuralnet-rmse">-</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <div class="mt-6">
                                <h4 class="text-lg font-semibold mb-3">Arquitectura de Red</h4>
                                <div id="neuralnet-architecture" class="p-4 bg-gray-100 rounded">
                                    <p>Capas: Input [n] → Dense [64] → Dense [32] → Dense [16] → Output [1]</p>
                                    <p>Activación: ReLU en capas ocultas, Lineal en salida</p>
                                    <p>Optimizador: Adam</p>
                                </div>
                            </div>
                        </div>
                        <div>
                            <h4 class="text-lg font-semibold mb-3">Visualización de Resultados</h4>
                            <div class="chart-container">
                                <canvas id="neuralnetChart"></canvas>
                            </div>
                            <div class="mt-6">
                                <h4 class="text-lg font-semibold mb-3">Próximos 7 días (Pronóstico)</h4>
                                <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-7 gap-3" id="neuralnet-forecast">
                                    <!-- Forecast cards will be added here by JavaScript -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Hybrid Model Tab Content -->
            <div id="content-hybrid" class="tab-content">
                <div class="bg-white rounded-lg shadow-lg p-6">
                    <h3 class="text-2xl font-semibold text-indigo-700 mb-4">Pronóstico Modelo Híbrido (LightGBM + Redes Neuronales)</h3>
                    <div class="grid md:grid-cols-2 gap-8">
                        <div>
                            <h4 class="text-lg font-semibold mb-3">Resultados Numéricos</h4>
                            <div class="table-container mb-6">
                                <table id="hybridResults" class="w-full">
                                    <thead>
                                        <tr>
                                            <th>Fecha</th>
                                            <th>Predicción</th>
                                            <th>Valor Actual</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td colspan="3" class="text-center py-4 text-gray-500">Cargue los datos y ejecute el modelo para ver resultados</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <h4 class="text-lg font-semibold mb-3">Métricas de Error</h4>
                            <div class="table-container">
                                <table id="hybridErrors" class="w-full">
                                    <thead>
                                        <tr>
                                            <th>Métrica</th>
                                            <th>Valor</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>MSE (Error Cuadrático Medio)</td>
                                            <td id="hybrid-mse">-</td>
                                        </tr>
                                        <tr>
                                            <td>MAE (Error Absoluto Medio)</td>
                                            <td id="hybrid-mae">-</td>
                                        </tr>
                                        <tr>
                                            <td>RMSE (Raíz del Error Cuadrático Medio)</td>
                                            <td id="hybrid-rmse">-</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <div class="mt-6">
                                <h4 class="text-lg font-semibold mb-3">Funcionamiento del Modelo Híbrido</h4>
                                <div class="p-4 bg-gray-100 rounded">
                                    <p>Este modelo combina las predicciones de LightGBM como entradas adicionales para una red neuronal, aprovechando las fortalezas de ambos enfoques.</p>
                                    <p class="mt-2">Ponderación: 60% Red Neuronal, 40% LightGBM</p>
                                </div>
                            </div>
                        </div>
                        <div>
                            <h4 class="text-lg font-semibold mb-3">Visualización de Resultados</h4>
                            <div class="chart-container">
                                <canvas id="hybridChart"></canvas>
                            </div>
                            <div class="mt-6">
                                <h4 class="text-lg font-semibold mb-3">Próximos 7 días (Pronóstico)</h4>
                                <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-7 gap-3" id="hybrid-forecast">
                                    <!-- Forecast cards will be added here by JavaScript -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- LSTM Tab Content -->
            <div id="content-lstm" class="tab-content" style="display: none;">
                <div class="bg-white rounded-lg shadow-lg p-6">
                    <h3 class="text-2xl font-semibold text-indigo-700 mb-4">Pronóstico LSTM</h3>
                    <div class="grid md:grid-cols-2 gap-8">
                        <div>
                            <h4 class="text-lg font-semibold mb-3">Resultados Numéricos</h4>
                            <div class="table-container mb-6">
                                <table id="lstmResults" class="w-full">
                                    <thead>
                                        <tr>
                                            <th>Fecha</th>
                                            <th>Predicción</th>
                                            <th>Valor Actual</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td colspan="3" class="text-center py-4 text-gray-500">Cargue los datos y ejecute el modelo para ver resultados</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <h4 class="text-lg font-semibold mb-3">Métricas de Error</h4>
                            <div class="table-container">
                                <table id="lstmErrors" class="w-full">
                                    <thead>
                                        <tr>
                                            <th>Métrica</th>
                                            <th>Valor</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>MSE (Error Cuadrático Medio)</td>
                                            <td id="lstm-mse">-</td>
                                        </tr>
                                        <tr>
                                            <td>MAE (Error Absoluto Medio)</td>
                                            <td id="lstm-mae">-</td>
                                        </tr>
                                        <tr>
                                            <td>RMSE (Raíz del Error Cuadrático Medio)</td>
                                            <td id="lstm-rmse">-</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <div>
                            <h4 class="text-lg font-semibold mb-3">Visualización de Resultados</h4>
                            <div class="chart-container">
                                <canvas id="lstmChart"></canvas>
                            </div>
                            <div class="mt-6">
                                <h4 class="text-lg font-semibold mb-3">Próximos 7 días (Pronóstico)</h4>
                                <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-7 gap-3" id="lstm-forecast">
                                    <!-- Forecast cards will be added here by JavaScript -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- LSTM-NN Hybrid Tab Content -->
            <div id="content-lstm-nn" class="tab-content" style="display: none;">
                <div class="bg-white rounded-lg shadow-lg p-6">
                    <h3 class="text-2xl font-semibold text-indigo-700 mb-4">Pronóstico LSTM-Redes Neuronales</h3>
                    <div class="grid md:grid-cols-2 gap-8">
                        <div>
                            <h4 class="text-lg font-semibold mb-3">Resultados Numéricos</h4>
                            <div class="table-container mb-6">
                                <table id="lstmNnResults" class="w-full">
                                    <thead>
                                        <tr>
                                            <th>Fecha</th>
                                            <th>Predicción</th>
                                            <th>Valor Actual</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td colspan="3" class="text-center py-4 text-gray-500">Cargue los datos y ejecute el modelo para ver resultados</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <h4 class="text-lg font-semibold mb-3">Métricas de Error</h4>
                            <div class="table-container">
                                <table id="lstmNnErrors" class="w-full">
                                    <thead>
                                        <tr>
                                            <th>Métrica</th>
                                            <th>Valor</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>MSE (Error Cuadrático Medio)</td>
                                            <td id="lstm-nn-mse">-</td>
                                        </tr>
                                        <tr>
                                            <td>MAE (Error Absoluto Medio)</td>
                                            <td id="lstm-nn-mae">-</td>
                                        </tr>
                                        <tr>
                                            <td>RMSE (Raíz del Error Cuadrático Medio)</td>
                                            <td id="lstm-nn-rmse">-</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <div class="mt-6">
                                <h4 class="text-lg font-semibold mb-3">Arquitectura del Modelo</h4>
                                <div class="p-4 bg-gray-100 rounded">
                                    <p>Combina LSTM para captura temporal con Redes Neuronales para patrones complejos</p>
                                    <p class="mt-2">Ponderación: 70% LSTM, 30% Redes Neuronales</p>
                                </div>
                            </div>
                        </div>
                        <div>
                            <h4 class="text-lg font-semibold mb-3">Visualización de Resultados</h4>
                            <div class="chart-container">
                                <canvas id="lstmNnChart"></canvas>
                            </div>
                            <div class="mt-6">
                                <h4 class="text-lg font-semibold mb-3">Próximos 7 días (Pronóstico)</h4>
                                <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-7 gap-3" id="lstm-nn-forecast">
                                    <!-- Forecast cards will be added here by JavaScript -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- LSTM-LightGBM Hybrid Tab Content -->
            <div id="content-lstm-lightgbm" class="tab-content" style="display: none;">
                <div class="bg-white rounded-lg shadow-lg p-6">
                    <h3 class="text-2xl font-semibold text-indigo-700 mb-4">Pronóstico LSTM-LightGBM</h3>
                    <div class="grid md:grid-cols-2 gap-8">
                        <div>
                            <h4 class="text-lg font-semibold mb-3">Resultados Numéricos</h4>
                            <div class="table-container mb-6">
                                <table id="lstmLightgbmResults" class="w-full">
                                    <thead>
                                        <tr>
                                            <th>Fecha</th>
                                            <th>Predicción</th>
                                            <th>Valor Actual</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td colspan="3" class="text-center py-4 text-gray-500">Cargue los datos y ejecute el modelo para ver resultados</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <h4 class="text-lg font-semibold mb-3">Métricas de Error</h4>
                            <div class="table-container">
                                <table id="lstmLightgbmErrors" class="w-full">
                                    <thead>
                                        <tr>
                                            <th>Métrica</th>
                                            <th>Valor</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>MSE (Error Cuadrático Medio)</td>
                                            <td id="lstm-lightgbm-mse">-</td>
                                        </tr>
                                        <tr>
                                            <td>MAE (Error Absoluto Medio)</td>
                                            <td id="lstm-lightgbm-mae">-</td>
                                        </tr>
                                        <tr>
                                            <td>RMSE (Raíz del Error Cuadrático Medio)</td>
                                            <td id="lstm-lightgbm-rmse">-</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <div class="mt-6">
                                <h4 class="text-lg font-semibold mb-3">Arquitectura del Modelo</h4>
                                <div class="p-4 bg-gray-100 rounded">
                                    <p>Combina LSTM para series temporales con LightGBM para gradient boosting</p>
                                    <p class="mt-2">Ponderación: 60% LSTM, 40% LightGBM</p>
                                </div>
                            </div>
                        </div>
                        <div>
                            <h4 class="text-lg font-semibold mb-3">Visualización de Resultados</h4>
                            <div class="chart-container">
                                <canvas id="lstmLightgbmChart"></canvas>
                            </div>
                            <div class="mt-6">
                                <h4 class="text-lg font-semibold mb-3">Próximos 7 días (Pronóstico)</h4>
                                <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-7 gap-3" id="lstm-lightgbm-forecast">
                                    <!-- Forecast cards will be added here by JavaScript -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- LSTM-XGBoost Hybrid Tab Content -->
            <div id="content-lstm-xgboost" class="tab-content" style="display: none;">
                <div class="bg-white rounded-lg shadow-lg p-6">
                    <h3 class="text-2xl font-semibold text-indigo-700 mb-4">Pronóstico LSTM-XGBoost</h3>
                    <div class="grid md:grid-cols-2 gap-8">
                        <div>
                            <h4 class="text-lg font-semibold mb-3">Resultados Numéricos</h4>
                            <div class="table-container mb-6">
                                <table id="lstmXgboostResults" class="w-full">
                                    <thead>
                                        <tr>
                                            <th>Fecha</th>
                                            <th>Predicción</th>
                                            <th>Valor Actual</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td colspan="3" class="text-center py-4 text-gray-500">Cargue los datos y ejecute el modelo para ver resultados</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <h4 class="text-lg font-semibold mb-3">Métricas de Error</h4>
                            <div class="table-container">
                                <table id="lstmXgboostErrors" class="w-full">
                                    <thead>
                                        <tr>
                                            <th>Métrica</th>
                                            <th>Valor</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>MSE (Error Cuadrático Medio)</td>
                                            <td id="lstm-xgboost-mse">-</td>
                                        </tr>
                                        <tr>
                                            <td>MAE (Error Absoluto Medio)</td>
                                            <td id="lstm-xgboost-mae">-</td>
                                        </tr>
                                        <tr>
                                            <td>RMSE (Raíz del Error Cuadrático Medio)</td>
                                            <td id="lstm-xgboost-rmse">-</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <div class="mt-6">
                                <h4 class="text-lg font-semibold mb-3">Arquitectura del Modelo</h4>
                                <div class="p-4 bg-gray-100 rounded">
                                    <p>Combina LSTM para secuencias temporales con XGBoost para patrones tree-based</p>
                                    <p class="mt-2">Ponderación: 65% LSTM, 35% XGBoost</p>
                                </div>
                            </div>
                        </div>
                        <div>
                            <h4 class="text-lg font-semibold mb-3">Visualización de Resultados</h4>
                            <div class="chart-container">
                                <canvas id="lstmXgboostChart"></canvas>
                            </div>
                            <div class="mt-6">
                                <h4 class="text-lg font-semibold mb-3">Próximos 7 días (Pronóstico)</h4>
                                <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-7 gap-3" id="lstm-xgboost-forecast">
                                    <!-- Forecast cards will be added here by JavaScript -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Consensus Model Tab Content -->
            <div id="content-consensus" class="tab-content">
                <div class="bg-white rounded-lg shadow-lg p-6">
                    <h3 class="text-2xl font-semibold text-indigo-700 mb-4">Pronóstico Consensuado (Todos los Modelos)</h3>
                    <div class="grid md:grid-cols-2 gap-8">
                        <div>
                            <h4 class="text-lg font-semibold mb-3">Resultados Numéricos</h4>
                            <div class="table-container mb-6">
                                <table id="consensusResults" class="w-full">
                                    <thead>
                                        <tr>
                                            <th>Fecha</th>
                                            <th>XGBoost</th>
                                            <th>LightGBM</th>
                                            <th>Red Neuronal</th>
                                            <th>Híbrido</th>
                                            <th>LSTM</th>
                                            <th>Consenso</th>
                                            <th>Actual</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td colspan="8" class="text-center py-4 text-gray-500">Cargue los datos y ejecute el modelo para ver resultados</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <div class="bg-blue-50 border border-blue-200 rounded p-4 mt-4">
                                <h4 class="text-lg font-semibold text-blue-800 mb-2">Ponderación del consenso</h4>
                                <div class="grid grid-cols-2 gap-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">XGBoost:</label>
                                        <input type="range" id="xgboost-weight" min="0" max="100" value="20" class="w-full">
                                        <span id="xgboost-weight-value" class="text-sm text-gray-600">20%</span>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">LightGBM:</label>
                                        <input type="range" id="lightgbm-weight" min="0" max="100" value="20" class="w-full">
                                        <span id="lightgbm-weight-value" class="text-sm text-gray-600">20%</span>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Redes Neuronales:</label>
                                        <input type="range" id="neuralnet-weight" min="0" max="100" value="20" class="w-full">
                                        <span id="neuralnet-weight-value" class="text-sm text-gray-600">20%</span>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Híbrido:</label>
                                        <input type="range" id="hybrid-weight" min="0" max="100" value="20" class="w-full">
                                        <span id="hybrid-weight-value" class="text-sm text-gray-600">20%</span>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">LSTM:</label>
                                        <input type="range" id="lstm-weight" min="0" max="100" value="20" class="w-full">
                                        <span id="lstm-weight-value" class="text-sm text-gray-600">20%</span>
                                    </div>
                                </div>
                                <button id="apply-weights" class="mt-4 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded text-sm">Aplicar ponderaciones</button>
                            </div>
                        </div>
                        <div>
                            <h4 class="text-lg font-semibold mb-3">Comparación Visual</h4>
                            <div class="chart-container">
                                <canvas id="consensusChart"></canvas>
                            </div>
                            <div class="mt-6">
                                <h4 class="text-lg font-semibold mb-3">Próximos 7 días (Pronóstico Consensuado)</h4>
                                <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-7 gap-3" id="consensus-forecast">
                                    <!-- Forecast cards will be added here by JavaScript -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Additional Information -->
        <div class="bg-white rounded-lg shadow-lg p-6 mb-8">
            <h2 class="text-2xl font-semibold text-indigo-700 mb-4">Información Adicional</h2>
            <div class="grid md:grid-cols-2 gap-8">
                <div>
                    <h3 class="text-lg font-semibold mb-3">Signos Numéricos</h3>
                    <div class="table-container">
                        <table class="w-full">
                            <thead>
                                <tr>
                                    <th>Signo</th>
                                    <th>Número</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr><td>Acuario</td><td>1</td></tr>
                                <tr><td>Aries</td><td>2</td></tr>
                                <tr><td>Cancer</td><td>3</td></tr>
                                <tr><td>Capricornio</td><td>4</td></tr>
                                <tr><td>Escorpion</td><td>5</td></tr>
                                <tr><td>Geminis</td><td>6</td></tr>
                                <tr><td>Leo</td><td>7</td></tr>
                                <tr><td>Libra</td><td>8</td></tr>
                                <tr><td>Piscis</td><td>9</td></tr>
                                <tr><td>Sagitario</td><td>10</td></tr>
                                <tr><td>Tauro</td><td>11</td></tr>
                                <tr><td>Virgo</td><td>12</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div>
                    <h3 class="text-lg font-semibold mb-3">Acerca de los Modelos</h3>
                    <div class="accordion">
                        <div class="mb-3">
                            <button class="accordion-btn flex justify-between items-center w-full bg-gray-100 p-3 rounded">
                                <span class="font-medium">XGBoost</span>
                                <i class="fas fa-chevron-down"></i>
                            </button>
                            <div class="accordion-content hidden p-3">
                                <p>XGBoost es un algoritmo de boosting basado en árboles de decisión. Es eficiente y efectivo para problemas de regresión y clasificación. Utiliza una técnica de "boosting" que mejora iterativamente las predicciones combinando múltiples modelos débiles.</p>
                            </div>
                        </div>
                        <div class="mb-3">
                            <button class="accordion-btn flex justify-between items-center w-full bg-gray-100 p-3 rounded">
                                <span class="font-medium">LightGBM</span>
                                <i class="fas fa-chevron-down"></i>
                            </button>
                            <div class="accordion-content hidden p-3">
                                <p>LightGBM es un framework de boosting por gradiente que utiliza algoritmos basados en árboles. Es más rápido y eficiente en memoria que XGBoost, especialmente para conjuntos de datos grandes, gracias a su enfoque de crecimiento de árboles por hoja.</p>
                            </div>
                        </div>
                        <div class="mb-3">
                            <button class="accordion-btn flex justify-between items-center w-full bg-gray-100 p-3 rounded">
                                <span class="font-medium">Redes Neuronales</span>
                                <i class="fas fa-chevron-down"></i>
                            </button>
                            <div class="accordion-content hidden p-3">
                                <p>Las redes neuronales son modelos inspirados en el cerebro humano. Consisten en capas de neuronas interconectadas que pueden aprender patrones complejos. Son especialmente efectivas para capturar relaciones no lineales en los datos.</p>
                            </div>
                        </div>
                        <div class="mb-3">
                            <button class="accordion-btn flex justify-between items-center w-full bg-gray-100 p-3 rounded">
                                <span class="font-medium">Modelo Híbrido</span>
                                <i class="fas fa-chevron-down"></i>
                            </button>
                            <div class="accordion-content hidden p-3">
                                <p>Un modelo híbrido combina las fortalezas de diferentes algoritmos. En este caso, utiliza tanto LightGBM como redes neuronales. LightGBM captura relaciones estructuradas mientras que las redes neuronales capturan patrones más complejos y no lineales.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <footer class="text-center py-6 text-gray-600">
            <p>© 2023 Pronóstico ASTROLUNA Premium | Versión 2.0</p>
        </footer>
    </div>

    <!-- External JavaScript files -->
    <script src="main.js"></script>
    <script src="xgboost.js"></script>
    <script src="lightgbm.js"></script>
    <script src="neuralnet.js"></script>
    <script src="hybrid.js"></script>
    <script src="lstm.js"></script>
    <script src="lstm-nn.js"></script>
    <script src="lstm-lightgbm.js"></script>
    <script src="lstm-xgboost.js"></script>
    <script src="consensus.js"></script>
    <script src="events.js"></script>
    <script>
        // Debug function for testing actual values in real-time
        function runDebugTest() {
            console.clear();
            const debugPanel = document.getElementById('debugPanel');
            const debugOutput = document.getElementById('debugOutput');
            
            debugPanel.classList.remove('hidden');
            debugOutput.innerHTML = '<p>🔍 Ejecutando test de debug...</p>';
            
            setTimeout(async () => {
                let output = '';
                
                try {
                    output += '=== TEST DE DEBUG DE VALORES ACTUALES ===<br>';
                    output += `Timestamp: ${new Date().toLocaleString()}<br><br>`;
                    
                    // Test 1: Check if data is loaded
                    if (processedData && processedData.processedData) {
                        output += `✅ Datos procesados: ${processedData.processedData.length} entradas<br>`;
                        
                        // Show sample values
                        const sample = processedData.processedData.slice(0, 3);
                        output += 'Muestra de datos procesados:<br>';
                        sample.forEach((item, index) => {
                            output += `  ${index}: DC=${item.DC}, EXT=${item.EXT}, Fecha=${item.date ? item.date.toLocaleDateString() : 'N/A'}<br>`;
                        });
                        output += '<br>';
                        
                        // Test 2: Prepare model data
                        const modelData = prepareDataForModels(processedData, 'DC', 7);
                        output += `✅ Datos del modelo preparados<br>`;
                        output += `  Entrenamiento: ${modelData.trainData.length} entradas<br>`;
                        output += `  Prueba: ${modelData.testData.length} entradas<br><br>`;
                        
                        if (modelData.testData.length > 0) {
                            output += 'Valores DC de datos de prueba:<br>';
                            const dcValues = modelData.testData.map(item => item.DC);
                            output += `  ${dcValues.join(', ')}<br>`;
                            output += `  Rango: ${Math.min(...dcValues)} - ${Math.max(...dcValues)}<br><br>`;
                        }
                        
                        // Test 3: Check XGBoost predictions if they exist
                        if (window.xgboostPredictions && window.xgboostPredictions.length > 0) {
                            output += `✅ Predicciones XGBoost encontradas: ${window.xgboostPredictions.length}<br>`;
                            const actualValues = window.xgboostPredictions
                                .filter(p => p.actual !== null && p.actual !== undefined)
                                .map(p => p.actual);
                            if (actualValues.length > 0) {
                                output += `  Valores actuales: ${actualValues.slice(0, 10).join(', ')}<br>`;
                                output += `  Rango: ${Math.min(...actualValues)} - ${Math.max(...actualValues)}<br>`;
                            } else {
                                output += '  ❌ No se encontraron valores actuales válidos<br>';
                            }
                        } else {
                            output += '⚠️ No hay predicciones XGBoost. Ejecute los modelos primero.<br>';
                        }
                        
                    } else {
                        output += '❌ No hay datos procesados disponibles.<br>';
                        output += 'Acciones sugeridas:<br>';
                        output += '1. Hacer clic en "Cargar Datos de Demostración"<br>';
                        output += '2. O hacer clic en "Ejecutar Modelos"<br>';
                    }
                    
                    // Test 4: Direct CSV test
                    output += '<br>=== PRUEBA DIRECTA DE CSV ===<br>';
                    try {
                        const response = await fetch('ProHOY-ASTROLUNA.csv');
                        const text = await response.text();
                        const lines = text.split('\\n').slice(0, 4);
                        lines.forEach(line => {
                            output += `  ${line}<br>`;
                        });
                    } catch (csvError) {
                        output += `❌ Error cargando CSV: ${csvError.message}<br>`;
                    }
                    
                } catch (error) {
                    output += `❌ Error en debug: ${error.message}<br>`;
                }
                
                debugOutput.innerHTML = output;
            }, 100);
        }
    </script>
</body>
</html>